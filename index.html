<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CORS Quick Test</title>
<style>
  body{font-family:system-ui,Arial;padding:18px;max-width:820px;margin:24px auto;color:#111}
  h2{margin:0 0 6px}
  label{display:block;margin-top:10px;font-weight:600}
  input,select,button{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ddd;box-sizing:border-box}
  button{background:#0b74ff;color:#fff;border:none;cursor:pointer;padding:10px}
  .warn{background:#fff4f0;color:#7a2b1b;padding:10px;border-radius:6px;margin-top:12px}
  #demo{white-space:pre-wrap;background:#f6f8fb;padding:10px;border-radius:6px;margin-top:12px;border:1px solid #e6eef8}
</style>
</head>
<body>

<h2>Quick CORS Test (safe)</h2>
<p>Use this to test whether a browser can <strong>read</strong> the response from a cross-origin endpoint when credentials are included. <strong>No exfiltration.</strong></p>

<div class="warn">
⚠️ Only test against your own site or staging/test accounts. Do NOT point to production endpoints with real users without permission.
</div>

<label>Target URL</label>
<input id="url" type="url" value="https://api-js.mixpanel.com/track/?verbose=1&ip=1&_=1758868364600" />

<label>HTTP method</label>
<select id="method">
  <option>GET</option>
  <option selected>POST</option>
</select>

<label>Body (for POST, x-www-form-urlencoded)</label>
<input id="body" value="data=test" />

<label>Use credentials (cookies)</label>
<select id="creds">
  <option value="include" selected>include</option>
  <option value="omit">omit</option>
  <option value="same-origin">same-origin</option>
</select>

<button id="run">Run test</button>

<div id="demo">Response will appear here (and in console).</div>

<script>
document.getElementById('run').onclick = function() {
  const url = document.getElementById('url').value.trim();
  const method = document.getElementById('method').value;
  const body = document.getElementById('body').value;
  const creds = document.getElementById('creds').value;
  const demo = document.getElementById('demo');

  if (!url) { alert('Enter target URL'); return; }
  demo.textContent = 'Sending ' + method + ' to ' + url + ' ... (check console/network)';

  // Use XMLHttpRequest similar to your screenshot
  try {
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState === 4) {
        const statusLine = 'Status: ' + this.status + ' ' + this.statusText;
        const headers = this.getAllResponseHeaders();
        const body = this.responseText || '';
        const out = statusLine + '\n\nRESPONSE HEADERS:\n' + headers + '\n\nBODY (preview):\n' + body.slice(0,2000);
        console.log('CORS test result object:', {status:this.status, headers: headers, body: body});
        // show it on page and alert (so triage can screenshot)
        demo.textContent = out;
        alert('Response received — check page and console');
      }
    };

    xhttp.open(method, url, true);
    xhttp.withCredentials = (creds === 'include');
    if (method === 'POST') {
      xhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      xhttp.send(body);
    } else {
      xhttp.send();
    }
  } catch (e) {
    console.error(e);
    demo.textContent = 'Request error: ' + e;
  }
};
</script>

</body>
</html>
